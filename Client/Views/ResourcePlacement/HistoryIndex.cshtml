@using System.Net.Http
@{
}
<div class="recent-orders table-responsive">
    <table class="table table-striped table-hover" id="interviewTable">
        <thead class="table-dark">
            <tr>
                <th>No</th>
                <th>Name</th>
                <th>Client</th>
                <th>Position</th>
                <th>Interview Date</th>
                <th>Is Accepted</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
    </table>
</div>

@section Scripts
{
    <script>
        const Token = '@Context.Session.GetString("JWToken")'
        $(document).ready(function () {
            loadInterviewData();
        });
        function loadInterviewData() {
            $('#interviewTable').DataTable({
                ajax: {
                    url: "https://localhost:7273/api/histories/GetAllHistorieswithName",
                    dataType: "JSON",
                    dataSrc: "data",
                    headers: {
                        'Authorization': 'Bearer ' + Token
                    }
                },
                columns: [
                    {
                        data: null,
                        render: function (data, type, row, meta) {
                            return meta.row + 1;
                        }
                    },
                    { data: "fullName" },
                    { data: "clientName" },
                    { data: "positionName" },
                    {
                        data: 'interviewDate',
                        render: function (data, type, row) {
                            return moment(data).format("D MMMM YYYY, HH:mm");;
                        }
                    },
                    {
                        data: "isAccepted",
                        render: function (data, type, row) {
                            return data === true ? `<box-icon type='solid' name='user-check' color='green' size='md'></box-icon>` : `<box-icon type='solid' name='user-x' color ='red' size='md'></box-icon>`;
                        }
                    },
                    {
                        data: "status",
                        render: function (data, type, row) {
                            if (data == 0) {
                                return `<box-icon name='loader'></box-icon>`
                            }
                            if (data == 1) {
                                return `<box-icon name='calendar-check' ></box-icon>`
                            }
                            if (data == 2) {
                                return `<box-icon name='calendar-x' type='solid' ></box-icon>`
                            }
                            if (data == 3) {
                                return `<box-icon type='solid' name='check-circle'></box-icon>`
                            }
                            if (data == 4) {
                                return `<box-icon type='solid' name='x-circle'></box-icon>`
                            }
                            return data === true ? `<box-icon type='solid' name='user-check' color='green' size='md'></box-icon>` : `<box-icon type='solid' name='user-x' color ='red' size='md'></box-icon>`;
                        }
                    },
                    {
                        data: null,
                        render: function (data, type, row) {
                            return `<button onclick="ShowUpdateInterview('${row.guid}')" data-bs-toggle="modal" data-bs-target="#modalUpdateInterview" class="btn btn-info" data-bs-placement="top" title="Update Data"><i class='bx bx-edit'></i></button>` +
                                `   <button onclick="deleteInterview('${row.guid}')" class="btn btn-danger" data-bs-toggle="modal" data-bs-placement="top" title="Delete Data"><i class='bx bxs-trash-alt'></i></button>`;
                        }
                    }
                ],
                "dom":
                    "<'row'<'col-md-8'B><'col-md-4'f>>" +
                    "<'row'<'col-sm-12'tr>>" + // Tabel
                    "<'row'<'col-md-5'i><'col-md-3 mt-2 mx-auto'l><'col-md-4'p>>",
                "buttons": [
                    {
                        extend: 'copy',
                        text: '<i class="bx bxs-copy"></i>',
                        className: 'btn btn-custom',
                        title: 'Copy'
                    },
                    {
                        extend: 'csv',
                        text: '<i class="bx bxs-file-export"></i>',
                        className: 'btn btn-custom'
                    },
                    {
                        extend: 'excel',
                        text: '<i class="bx bx-file-blank"></i>',
                        className: 'btn btn-custom'
                    },
                    {
                        extend: 'pdf',
                        text: '<i class="bx bxs-file-pdf"></i>',
                        className: 'btn btn-custom'
                    },
                    {
                        extend: 'print',
                        text: '<i class="bx bx-printer"></i>',
                        className: 'btn btn-custom'
                    },
                    {
                        extend: 'colvis',
                        text: '<i class="bx bx-show-alt"></i>', // Ganti teks dengan ikon Boxicons
                        className: 'btn btn-custom-column-vis'
                    }
                ],
                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                "pageLength": 25
            });
        }
    </script>
}
